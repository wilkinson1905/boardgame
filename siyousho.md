## ボードゲーム仕様書 — 補給ライン（仮題）

作成日: 2025-08-23

### 概要
ヘックスマップ上で展開するターン制の2人対戦ボードゲーム。各陣営はマップ端にある倉庫（補給源）からトラックに兵士コマ・弾薬コマ・食料コマを乗せ、中央の前線へ補給・増援を送り込む。工兵コマで道路をアップグレードするとトラックの移動効率が上がる。最終的にある陣営の兵士数が0になった時点でその陣営が敗北する。

---

## 目的
相手の兵力を減らし、自陣の兵力を維持して相手を兵力0にすること。

---

## 前提・想定（明確化された要件と仮定）
- プレイヤー数: 2（A陣営 / B陣営）。
- 各陣営のトラックコマ数: 5（ユーザ指定）。
- マップ: ヘックス（六角）グリッド。マップサイズは設計段階で可変（例: 幅 15 x 高さ 11 の六角アレンジ）。
- ターン構造はフェーズ単位（移動フェーズ、攻撃フェーズ、食事（補給）フェーズ）。
- 下位の未指定仕様はこの仕様書で合理的に仮定している（明示）。

---

## コンポーネント（物理／抽象）
- 六角タイルのマップ（タイルは道路/未舗装/障害物/拠点 等の種類を持つ）
- 各陣営: 倉庫（Warehouse）x1、トラックコマ x5、兵士コマ（複数）
- 物資トークン: 弾薬トークン、食料トークン
- 工兵コマ（Engineer）: 道路をアップグレードする専用ユニット
- ターンマーカー、移動ポイント（MP）インジケーター、履歴トラック（任意）

---

## セットアップ
1. マップを中央に配置。両端に互いに向かい合う形で倉庫タイルを配置する（Aは左端、Bは右端など）。
2. 各プレイヤーは自陣倉庫にトラック5台を配置する（倉庫から出発する状態）。
3. 初期兵力・弾薬・食料を決定する（例: 兵士20、弾薬20、食料20）。これはゲーム調整用パラメータとして後述。
4. 道路タイルは初期で「未改良（unupgraded）」。工兵駒はそれぞれ初期で2〜3コマを所持（チューニング可能）。

---

## ターン構成（1ラウンド）
1. トラック移動フェーズ（プレイヤーAの移動→プレイヤーBの移動）
   - 各プレイヤーは自陣のトラックを順に移動できる（各トラックはこのフェーズで最大MPを使って移動）。
2. 攻撃フェーズ（プレイヤーAの攻撃→プレイヤーBの攻撃）
   - 各プレイヤーは前線での攻撃を解決する（詳細は下）。
3. 食事（補給）フェーズ（同時解決）
   - 各陣営は保有する兵士数分の食料を消費。足りなければ兵士が減少する。
4. 勝利判定
   - いずれかの陣営の兵士数が0になればゲーム終了、その陣営の敗北。

注: 上記の「プレイヤーA先行」は任意。先行後攻ルールや先行メリットを調整可能。

---

## トラック移動ルール
- 各トラックは1ターンあたり基本移動力 (MP) = 6。
- タイル移動コスト:
  - アップグレード済み道路: 1 MP / タイル
  - 未改良道路（通常の道）: 2 MP / タイル
  - 非道路（草地等）: 3 MP / タイル（設計例。必要なら移動不可にもできる）
- トラックは倉庫から出発し、前線ヘックスへ向かう。トラック上には以下を搭載可能:
  - 兵士コマ（士気や数を表す）
  - 弾薬トークン
  - 食料トークン
  - 工兵コマ（オプションとして搭載可）
- 積載制限: 各トラックは「容量ポイント」を持ち、兵士1コマ=1、弾薬1トークン=1、食料1トークン=1、工兵1コマ=1 と数える（例: 容量 = 10）。この数値は調整可能。
- 移動中にトラックは他トラックを追い越し可能。複数トラックが同一ヘックスに止まれる（スタック）上限は調整可能（例: 無制限または3台まで）。
- トラックが敵拠点や前線ヘックス（接敵）に到達した場合、そのヘックスで荷降ろし・戦闘等が起こり得る。

---

## 工兵（道路アップグレード）
- 工兵コマは単独でも、またはトラックに搭載して移動できる。
- 道路アップグレードの手順:
  1. 工兵がアップグレード対象ヘックスに存在し、改良を開始する（荷降ろししてそのヘックスに留まる）。
  2. 改良には工兵1コマあたり1ターンを消費し、費用として資材（任意の追加リソース）または工兵の行動のみとする。
  3. 改良が完了するとそのヘックスは「アップグレード済み道路」になり、以後トラック移動コストが1になる。
- アップグレードは永続（ゲーム終了まで）。敵が来て破壊可能にするルールも設計可能（拡張）。

---

## 兵士・弾薬・食料の取り扱い
- 兵士は「常駐」（陣地にいる）または「トラック搭載」の状態を持つ。トラックから降ろすことで前線へ展開する。
- 弾薬: 攻撃時に消費される。攻撃命令を出した場合、攻撃に参加する兵士数と同数の弾薬を消費する（不足時は攻撃不可または消費可能な分だけで低効率攻撃）。
- 食料: 食事フェーズで兵士1人につき食料1を消費する（例）。食料が不足した場合、欠食ペナルティとしてそのターンに兵士が減少する（後述）。食料はトラックで前線に運搬する必要がある。

---

## 攻撃ルール（概略）
目的: 攻撃側が成功すれば敵兵力を一定数削減する。

1. 攻撃準備
   - 攻撃を行うには、攻撃側は前線の同一ヘックスまたは隣接ヘックスに兵士が配置され、かつ弾薬を兵士数分消費できること。
2. 攻撃判定（確率）
   - 基本概念: 攻撃成功確率は「攻撃兵力」と「防御兵力」の相対比に依存。比率が高いほど成功確率が上昇。
   - 例: 成功確率 P = clamp(0.5 + 0.15 * (A/D - 1), 0.05, 0.95)
     - A = 攻撃に参加する兵士数
     - D = 防御側の兵士数（防御ヘックスにいる兵士の合計。0の場合は自動成功）
     - clamp(x,min,max) は x を [min,max] に丸める関数
   - 上式は調整用の例。チューニングパラメータ（0.15 等）はバランス調整可能。
3. 成功時の効果
   - 攻撃が成功した場合、被害量は攻撃兵力に基づき決定。
   - 例: 被害 = floor(A * damage_ratio)（damage_ratio = 0.3〜0.6 の範囲で調整）
   - 被害は防御側の兵士数から差し引かれる（最小 1）。
4. 失敗時の効果
   - 攻撃が失敗した場合、攻撃側の損耗を若干受ける（例: floor(A * 0.1)）か、弾薬のみ消費で兵士は温存する、など選択可能。
5. 両者の攻撃順序
   - 本仕様ではプレイヤーA→Bの順で攻撃を行う（順序の代替: 同時解決も検討可）。攻撃の結果は即時適用され、次のプレイヤーの攻撃に反映される。

注意: この戦闘モデルはシンプルな確率解決型。より複雑な戦闘解決（士気、地形ボーナス、砲兵支援など）は拡張可能。

---

## 食事（補給）フェーズ
- フェーズで各陣営は自陣の総兵士数分の食料を消費する。
- 食料が不足した場合:
  - 食料が 0 ならそのターンに各ターン毎に欠食ペナルティを適用（例: 兵士数の10%を失う、最小1人）。
  - 食料が部分的に不足している場合は優先順位を決める（前線の兵士優先やランダム配分など）。
- 食料はトラックで前線に送り届ける必要がある。倉庫は食料供給源として無限（調整可能）または有限に設定可能。

---

## 勝利条件
- いずれかの陣営の総兵士数が0になった時点でその陣営の敗北、相手の勝利。
- 補助勝利条件（オプション）:
  - 規定ラウンド（例: 30ラウンド）経過時点で兵士数が多い方が勝利。
  - 中央拠点を一定ターン数以上支配することで勝利、等。

---

## データモデル（設計者向け）
（プログラム化を想定した最低限のデータ形）
- Map: array of Hex { id, coords, terrainType, roadUpgraded: bool, occupants: list }
- PlayerState: { id, warehouses: list, trucks: list<Truck>, soldiers: int, ammo: int, food: int, engineers: int }
- Truck: { id, ownerId, position: hexId, capacity: int, cargo: { soldiers:int, ammo:int, food:int, engineers:int }, remainingMP:int }
- CombatAction: { attackerId, defenderHexId, attackingSoldiers:int }

---

## 代表的なパラメータ（チューニング用）
- トラックMP: 6
- 未改良道コスト: 2
- 改良道コスト: 1
- 初期兵士: 20（例）
- 初期弾薬: 20（例）
- 初期食料: 20（例）
- 工兵数: 2（例）
- ダメージ係数（成功時）: 0.4（攻撃兵力の40%を被害として与える）

---

## 主要なエッジケースと対処法
- 弾薬不足で攻撃できない: 弾薬が足りない場合は攻撃不可または弱体化（消費できるだけ消費して部分的攻撃をする）
- トラックの重複スタック数が多すぎる: 1ヘックスあたりの上限を設定（例: 3台）
- 工兵が途中で殺される/撤退する: 工兵も通常の兵力扱いで、死亡すればアップグレードは中断
- 食料が極端に枯渇する: 倉庫側に救援ルール（ターン毎に少量の自動供給）を設ける

---

## プレイ例（短いフロー）
1. ラウンド開始。Aの移動フェーズ: Aはトラック1をMP6で前進。未改良道は1タイルで2MP消費。トラックは兵士5・弾薬5を搭載。
2. Bの移動フェーズ: Bもトラックを移動させ、前線で待機させる。
3. 攻撃フェーズ: Aの攻撃。Aは前線で兵士4を使って隣接の敵ヘックスに攻撃指示。弾薬4を消費。攻撃成功確率を計算してダイス判定し、成功なら被害を与える。
4. Bの攻撃: Bも同様に行う。
5. 食事フェーズ: 両者それぞれ兵士数分の食料を消費。食料不足なら欠食ペナルティで兵力が減る。

---

## 拡張案／デザインメモ
- 地形効果: 丘陵・森などを追加し防御ボーナスや視界を実装
- 車両の種類: 高速トラック／装甲トラック（耐久）等を導入
- 補給線遮断: 敵の道路を破壊して補給を止める要素
- マルチプレイヤー: 2 > N の同盟戦モード

---

## 次の作業（実装フェーズへの移行指針）
1. 本仕様の数値パラメータ（初期値、係数）を1〜3セット用意してプレイテストする。
2. 優先実装: マップとトラックの移動、搭載・荷降ろし、攻撃解決、食料管理のコアルール。
3. UI/UX設計: トラックの選択・搭載管理、MP表示、行動ログを優先。

---

## 仕様カバレッジ（依頼事項との対応）
- ヘックスマップのターン方式のボードゲーム: 記載済
- 中央の前線に兵士や弾薬や食料を送る兵站の管理: 記載済
- 倉庫→トラック→前線の運搬: 記載済
- トラックコマは5個: セットアップに明記済
- 工兵コマと道のアップグレード効果: 記載済
- トラック移動: 1ターンで6マス、未改良道は2マス分消費の扱いを記載（MP=6, cost未改良=2）
- トラック移動後に攻撃ターン、その後食事ターン: ターン構成に明記済
- 攻撃は弾薬を兵士数分消費し、兵力比により成功率が上がる: 記載済（弾薬消費と成功確率モデルを提示）
- 攻撃成功で敵兵士を減らす: 成功時の被害計算例を提示
- 兵士が0になった陣営が負け: 勝利条件に明記済

---

注：本仕様はプログラム化を念頭に置いたゲームデザイン仕様です。未指定の細部（例えばマップの具体的サイズ、初期値）についてはプレイテストにより調整してください。

---

Prepared by: ゲーム設計仕様自動生成
